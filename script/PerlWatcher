#!/usr/bin/env perl

use 5.12.0;
use strict;
use warnings;

use Carp;
use Devel::Comments;
use FindBin;

BEGIN { unshift @INC, "$FindBin::Bin/../lib" }

use App::PerlWatcher::Engine;

my $timeout   = 1;

my $config_file = $ARGV[0];

open(my $config_fh, "<", $config_file) 
    or croak("Can't open config file $config_file");

my $content_config = do { local $/ = <$config_fh> };
my $config = eval "no warnings; $content_config ";
croak("error in config: $@") if ( $@ );

my $engine = App::PerlWatcher::Engine->new($config);
my $app = $engine->guess_frontend;
$app->show;

$engine->start;

1;
